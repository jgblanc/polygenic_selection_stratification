# Snakefile to do the pre-data processing for the Test Example
CHR =[]
for i in range(1, 23):
  CHR.append(str(i))
CONTRASTS = ["England-NorthernIreland", "England-RepublicOfIrelend", "England-Scotland", "England-Wales", "NorthernIreland-RepublicOfIrelend", "NorthernIreland-Scotland", "NorthernIreland-Wales", "RepublicOfIrelend-Scotland", "RepublicOfIrelend-Wales", "Scotland-Wales"]
#GWAS=["q1", "q2", "q3", "q4"]
GWAS=["q1"]



rule all:
    input:
        expand("data/InUKBB/variantFreq/CountryOfBirthUK.txt_{chr}.afreq", chr=CHR, gwas=GWAS, contrasts=CONTRASTS, subdataset=SUBDATASET)


## Get overlapping SNPs for each subdataset

# Get allele freq in test panel

rule get_AF_Test:
    input:
        test="data/InUKBB/ids/test_ids/CountryOfBirthUK.txt.txt"
    output:
        test="data/InUKBB/variantFreq/CountryOfBirthUK.txt_{chr}.afreq"
    params:
        prefix_in="/scratch/jgblanc/ukbb/plink2-files/ALL/ukb_imp_chr{chr}_v3",
        prefix_out_test="data/InUKBB/variantFreq/CountryOfBirthUK_{chr}"
    resources:
        mem_mb=38000,
        time="00:30:00"
    shell:
        """
        plink2 --pfile {params.prefix_in} \
        --freq \
        --keep {input.test} \
	      --threads 8 \
        --memory 38000 \
        --out {params.prefix_out_test}
        """

