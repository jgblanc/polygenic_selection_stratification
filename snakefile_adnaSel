# Snakefile to do the pre-data processing for the Le et al aDNA contrasts
CHR = []
for i in range(1, 23):
  CHR.append(str(i))
CONTRASTS = ["EuropeanNeolithic", "BronzeAge", "Historical"]
GWAS=["e5", "e10", "e50", "e200"]
#GWAS=["q1"]

rule all:
    input:
        expand("data/adnaSel/r/{gwas}/{contrasts}_chr{chr}.rvec", chr=CHR, gwas=GWAS, contrasts=CONTRASTS)


# Process and match SNPs

rule flip_all_snps:
    input:
        freq="data/ukbb/variantFreq/{gwas}_{chr}.afreq",
	      contrasts="data/adnaSel/raw/all_populations_mles.txt"
    output:
        rvec=expand("data/adnaSel/r/{{gwas}}/{contrasts}_chr{{chr}}.rvec", contrasts = CONTRASTS),
        overlappingSNPs=expand("data/adnaSel/variants/{{gwas}}/{contrasts}/overlappingSNPs_chr{{chr}}.txt", contrasts=CONTRASTS)
    params:
        out_path_r="data/adnaSel/r/{gwas}/",
	out_path_snps="data/adnaSel/variants/{gwas}/"
    shell:
        """
        Rscript code/adnaSel/flip_overlapping_snps.R {input.freq} {input.contrasts} {params.out_path_r} {params.out_path_snps} {wildcards.chr}
        """




